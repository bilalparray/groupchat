<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Register</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <form #registerForm="ngForm" (ngSubmit)="submit(registerForm)" novalidate>
    <ion-list>
      <!-- Email -->
      <ion-item>
        <ion-label position="stacked">Email</ion-label>
        <ion-input type="email" name="email" required email [(ngModel)]="model.email" (blur)="onBlur('email')"
          [attr.autocomplete]="'email'">
        </ion-input>
      </ion-item>
      @if (showError('email')) {
      <div class="validation">
        @if (!model.email || model.email.trim() === '') {
        <small>Email is required.</small>
        }@else if(model.email && !isValidEmail(model.email)) {
        <small>Enter a valid email address.</small>}
      </div>}

      <!-- Password -->
      <ion-item>
        <ion-label position="stacked">Password</ion-label>
        <ion-input type="password" name="password" required minlength="6" [(ngModel)]="model.password"
          (blur)="onBlur('password')" [attr.autocomplete]="'new-password'">
        </ion-input>
      </ion-item>
      @if (showError('password')) {
      <div class="validation">
        @if (!model.password || model.password.trim() === '') {
        <small>Password is required.</small>
        } @else if (model.password && model.password.length < 6) { <small>Password must be at least 6
          characters.</small>
          }
      </div>
      }


      <!-- Confirm Password -->
      <ion-item>
        <ion-label position="stacked">Confirm Password</ion-label>
        <ion-input type="password" name="confirmPassword" required minlength="6" [(ngModel)]="model.confirmPassword"
          (blur)="onBlur('confirmPassword')" [attr.autocomplete]="'new-password'">
        </ion-input>
      </ion-item>
      @if (showError('confirmPassword')) {
      <div class="validation">
        @if (!model.confirmPassword || model.confirmPassword.trim() === '') {
        <small>Confirm Password is required.</small>
        } @else if (model.confirmPassword && model.confirmPassword.length < 6) { <small>Confirm Password must be at
          least 6 characters.</small>
          } @else if (model.confirmPassword && model.confirmPassword.length >= 6 && !passwordsMatch()) {
          <small>Passwords do not match.</small>
          }
      </div>
      }


      <ion-button expand="block" type="submit">Register</ion-button>

      <div class="links">
        <p>Already have an account? <a (click)="navigate('/login')">Login</a></p>
        <p><a (click)="navigate('/guest')">Join as Guest</a></p>
      </div>
    </ion-list>
  </form>
</ion-content>